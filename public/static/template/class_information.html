<div id="class-content" class="w-3/5 text-center">
    <p id="class-id" class="hidden">${}</p>
    <div id="chapter-content" class="flex flex-col h-auto p-4">
        <div id="btn-add-chapter" onclick="ShowModal({title: '新增章節', content: createChapterTemplate})" class="edit-nav text-center text-xl text-stone-400 border-dashed border border-stone-300 rounded-md w-full h-10 p-1 my-3 hover:cursor-pointer">新增章節</div>
    </div>
</div>
<script>
$(document).ready(function() {
    classId = $("#class-id").text();
    if(userData.Role === "Student")
        $(".edit-nav").addClass("hidden");

    $.ajax({
        type: "POST",
        url: "/GetClassInformation",
        data: {classId: classId},
        dataType: "JSON"
    })
    .then(function(res) {
        /*Implement success function here*/
        if(userData.Role === "Student")
            $(".edit-nav").addClass("hidden");
        if( res.status == true ) {
            res.data.forEach(function(item) {
                $.ajax({
                    type: "GET",
                    url: components["classChapter"],
                    dataType: "text"
                })
                .then(function(res) {
                    let chapters = $.tmpl(res, item);
                    chapters.insertBefore("#btn-add-chapter");
                    chapters.ready(function() {
                        if(userData.Role === "Student")
                            $(".edit-nav").addClass("hidden");
                    });
                });
            });    
        }
        else if( res.status == false ) {
            alert("課程資訊獲取失敗");
            console.log(res);
        }
    }, function(err) {
        alert("課程資訊獲取失敗");
        console.log(err);
    });
});

function OnSectionClick(e) {
    let section = $(e.currentTarget);
    let allSections = $("div.section");
    if(section.data("isopened")) {
        section.data("isopened", false);
        allSections.removeClass("h-[402px]");
        allSections.data("isopened", false);
    }
    else {
        allSections.removeClass("h-[402px]");
        allSections.data("isopened", false);
        section.data("isopened", true);
        section.addClass("h-[402px]");
    }

    /* 停止嵌入式畫面 */
    let videoPlayer = $("iframe");
    for(let i = 0; i < videoPlayer.length; i++) {
        videoPlayer[i].contentWindow.postMessage('{"event":"command","func":"stopVideo","args":""}', '*');
    }
}
</script>